const COLLAPSED_COMMENT_LENGTH=160;class SliderSingleReview extends React.Component{constructor(e){super(e),this.isShortComment=!e.review.comment||e.review.comment.length<=160,this.state={isExpanded:!1,deleteDialog:!1},this.editMyReview=this.editMyReview.bind(this),this.deleteMyReview=this.deleteMyReview.bind(this),this.handleDeleteDialog=this.handleDeleteDialog.bind(this)}editMyReview(){const e=this.props.review.uid;return this.props.store.dispatch(changeReview(e,this.props.host)),parent.postMessage({type:OPEN_ADD_REVIEW},"*")}deleteMyReview(){this.setState({deleteDialog:!0})}handleDeleteDialog(e){if(this.setState({deleteDialog:!1}),"edit"===e)return this.editMyReview();if("delete"===e){const e=this.props.review.uid;return this.props.store.dispatch(deleteReviewAction(e,this.props.host)),this.props.store.dispatch(setReviewInFocus(BlankReview)),window.parent.postMessage({type:CLOSE_ADD_REVIEW},"*")}}timeAgo(e){const t=[{name:"minute",limit:3600,in_seconds:60},{name:"hour",limit:86400,in_seconds:3600},{name:"day",limit:604800,in_seconds:86400},{name:"week",limit:2629743,in_seconds:604800},{name:"month",limit:31556926,in_seconds:2629743},{name:"year",limit:null,in_seconds:31556926}];let i=(new Date-new Date(1e3*e))/1e3;if(i<60)return{sentence:"justNow"};let s,a=0;for(;s=t[a++];)if(i<s.limit||!s.limit)return i=Math.floor(i/s.in_seconds),{value:i,sentence:s.name+(i>1?"s":"")+"Ago"}}normalizeReview(e){return{name:e.name,comment:this.isShortComment||this.state.isExpanded?e.comment:e.comment.slice(0,160)+"...",icon:e.picture,rating:e.rating,when:this.timeAgo(e.timestamp)}}render(){var e=this.props;const t=e.review,i=e.index,s=!i,a=this.normalizeReview(t);var n=this.state;const r=n.isExpanded;return n.deleteDialog?React.createElement(SliderDeleteDialog,{onChosen:this.handleDeleteDialog}):React.createElement("div",{className:"slider-review "+(s?"user-review":"r"+i)},s&&React.createElement("div",{className:"slider-user-review-icons"},React.createElement("div",{className:"edit-my-review",onClick:this.editMyReview}),React.createElement("div",{className:"delete-my-review",onClick:this.deleteMyReview})),React.createElement("div",{className:"review-avatar",style:this.props.avatarStyle},a.icon?React.createElement("img",{src:a.icon,alt:""}):React.createElement("span",null,a.name[0])),React.createElement("div",{className:"review-data "+(s?"user-review":"")},React.createElement("div",{className:"review-user-name"},a.name[0].toUpperCase()+a.name.slice(1)),React.createElement("div",{className:"review-stars-and-date"},getRatingStarsAndColor(a.rating,100).stars,React.createElement("div",{className:"review-time-ago"},translate(a.when.sentence).replace("%1%",a.when.value||""))),React.createElement("div",{className:"review-comment"},a.comment,!this.isShortComment&&React.createElement("span",{className:"toggle-all-review",onClick:()=>this.setState({isExpanded:!r})},r?translate("seeLess"):translate("seeMore")))))}}