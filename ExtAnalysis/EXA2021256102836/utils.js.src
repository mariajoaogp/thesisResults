const browserName=crossbrowserName,webextApi=crossbrowser,isContent=!!crossbrowser.windows,FULL_REPORT_URL=`https://${root}/${webextApi.i18n.getUILanguage().replace("_","-").substring(0,2)}/scorecard/`,WELCOME_URL_OLD=`https://www.mywot.com/${webextApi.i18n.getUILanguage().replace("_","-").substring(0,2)}/settings/welcome`,OPTIONS_URL="edge"===crossbrowserName?"/options.html":webextApi.runtime.getURL("/options.html"),OPTIN_URL="edge"===crossbrowserName?"/presettings.html":webextApi.runtime.getURL("/presettings.html"),CHROME_WEBSTORE_URL=`https://chrome.google.com/webstore/detail/wot-web-of-trust-website/${webextApi.runtime.id}/reviews/`;function truncateString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15;return e.length>t?`${e.slice(0,n)}...${e.slice(e.length-6)}`:e}function getCurrentTabFromPopupQueryString(){return!!/site=(.*)/.test(window.location.search)&&{url:RegExp.$1}}function upperFirstCase(e){return e.charAt(0).toUpperCase()+e.slice(1)}function makeid(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;const t="abcdefghijklmnopqrstuvwxyz0123456789";let n=t.charAt(Math.floor(26*Math.random()));for(let o=1;o<e;o++)n+=t.charAt(Math.floor(Math.random()*t.length));return n}function getAttr(e,t){return new URL(e).searchParams.get(t)||!1}function getShieldColor(e){let t=[],n=e&&e.color||"gray";const o=e&&e.safety||UNKNOWN;let r;return"object"==typeof e&&(t=e.categories.map(e=>e.id),o===NOT_SAFE?r="severe":o===SUSPICIOUS?(n="yellow",r=(e.rating<=MAX_RED_STRIP_RATING?"red":"yellow")+"strip"):o===SAFE&&(r="")),CATEGORIES_RULES.ratingFlow.childSafety.some(e=>t.includes(e))&&(r+="+parental"),t.includes(CATEGORIES_RULES.block.gambling)&&(r+="+gambling"),{color:n,warning:r}}function parseStatus(e){let t="Rookie";for(const n in ACTIVITY_SCORE_RULES){if(e<ACTIVITY_SCORE_RULES[n])break;t=n}return t}function getFacebookSharingUrl(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=webextApi.i18n.getMessage("shareTextFacebook"+(e?"Rate":"")).replace("%LINK%",e?FULL_REPORT_URL+e:FACEBOOK_SHARE_URL).replace("%WEBSITE%",getDecodedDomain(e)).replace("%STARS%",(t/20).toFixed(0));return`${FACEBOOK_DIALOG_URL}link=${e?FULL_REPORT_URL+e+encodeURIComponent(FACEBOOK_RATING_PARAMETERS):FACEBOOK_SHARE_URL}&description=${n}`}function getTwitterSharingUrl(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=webextApi.i18n.getMessage("shareTextTwitter"+(e?"Rate":"")).replace("%LINK%",e?FULL_REPORT_URL+e+encodeURIComponent(TWITTER_RATING_PARAMETERS):TWITTER_SHARE_URL).replace("%WEBSITE%",getDecodedDomain(e)).replace("%STARS%",(t/20).toFixed(0));return`${TWITTER_DIALOG_URL}&text=${n} via @web_of_trust`}function getGoogleSharingUrl(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=webextApi.i18n.getMessage("shareTextGoogle"+(e?"Rate":"")).replace("%LINK%",e?FULL_REPORT_URL+e:GOOGLE_SHARE_URL).replace("%WEBSITE%",getDecodedDomain(e)).replace("%STARS%",(t/20).toFixed(0));return`${GOOGLE_DIALOG_URL}&url=${e?FULL_REPORT_URL+e+encodeURIComponent(GOOGLE_RATING_PARAMETERS):GOOGLE_SHARE_URL}&text=${n}`}function getWhatsAppSharingUrl(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=webextApi.i18n.getMessage("shareTextWhatsApp"+(e?"Rate":"")).replace("%LINK%",e?FULL_REPORT_URL+e:WHATSAPP_SHARE_URL).replace("%WEBSITE%",getDecodedDomain(e)).replace("%STARS%",(t/20).toFixed(0));return`${WHATSAPP_DIALOG_URL}&text=${n}`}function injectFonts(){const e=document.createElement("link");e.href=FONTS_URL,e.rel="stylesheet",document.querySelector("head").appendChild(e)}const punycode={initial_n:128,initial_bias:72,delimiter:"-",base:36,damp:700,tmin:1,tmax:26,skew:38,maxint:2147483647,decode_digit:e=>e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:base,encode_digit:(e,t)=>e+22+75*(e<26)-((0!=t)<<5),adapt(e,t,n){let o;for(e=n?Math.floor(e/this.damp):e>>1,e+=Math.floor(e/t),o=0;e>(this.base-this.tmin)*this.tmax>>1;o+=this.base)e=Math.floor(e/(this.base-this.tmin));return Math.floor(o+(this.base-this.tmin+1)*e/(e+this.skew))},encode_basic:(e,t)=>(e-=(e-97<26)<<5)+((!t&&e-65<26)<<5),decode(e,t){const n=[],o=[],r=e.length;let i,s,a,c,l,d,h,u,g,f,p,w,m;for(i=this.initial_n,a=0,c=this.initial_bias,l=e.lastIndexOf(this.delimiter),l<0&&(l=0),d=0;d<l;++d){if(t&&(o[n.length]=e.charCodeAt(d)-65<26),e.charCodeAt(d)>=128)throw new RangeError("decode: illegal input >= 0x80");n.push(e.charCodeAt(d))}for(h=l>0?l+1:0;h<r;){for(u=a,g=1,f=this.base;;f+=this.base){if(h>=r)throw RangeError("decode: bad input (1)");if(p=this.decode_digit(e.charCodeAt(h++)),p>=this.base)throw RangeError("decode: bad input (2)");if(p>Math.floor((this.maxint-a)/g))throw RangeError("decode: overflow (1)");if(a+=p*g,w=f<=c?this.tmin:f>=c+this.tmax?this.tmax:f-c,p<w)break;if(g>Math.floor(this.maxint/(this.base-w)))throw RangeError("decode: overflow (2)");g*=this.base-w}if(s=n.length+1,c=this.adapt(a-u,s,0===u),Math.floor(a/s)>this.maxint-i)throw RangeError("decode: overflow (3)");i+=Math.floor(a/s),a%=s,t&&o.splice(a,0,e.charCodeAt(h-1)-65<26),n.splice(a,0,i),a++}if(t)for(a=0,m=n.length;a<m;a++)o[a]&&(n[a]=String.fromCharCode(n[a]).toUpperCase().charCodeAt(0));return toutf16.encode(n)},encode(e,t){let n,o,r,i,s,a,c,l,d,h,u,g;t&&(g=wot.idn.utf16.decode(e));const f=(e=wot.idn.utf16.decode(e.toLowerCase())).length;if(t)for(a=0;a<f;a++)g[a]=e[a]!=g[a];const p=[];for(n=this.initial_n,o=0,s=this.initial_bias,a=0;a<f;++a)e[a]<128&&p.push(String.fromCharCode(g?this.encode_basic(e[a],g[a]):e[a]));for(r=i=p.length,i>0&&p.push(this.delimiter);r<f;){for(c=this.maxint,a=0;a<f;++a)u=e[a],u>=n&&u<c&&(c=u);if(c-n>Math.floor((this.maxint-o)/(r+1)))throw RangeError("encode: overflow (1)");for(o+=(c-n)*(r+1),n=c,a=0;a<f;++a){if(u=e[a],u<n&&++o>this.maxint)throw RangeError("encode: overflow (2)");if(u==n){for(l=o,d=this.base;h=d<=s?this.tmin:d>=s+this.tmax?this.tmax:d-s,!(l<h);d+=this.base)p.push(String.fromCharCode(this.encode_digit(h+(l-h)%(this.base-h),0))),l=Math.floor((l-h)/(this.base-h));p.push(String.fromCharCode(this.encode_digit(l,t&&g[a]?1:0))),s=this.adapt(o,r+1,r==i),o=0,++r}}++o,++n}return p.join("")}};function toascii(e){if(/[[:]/.test(e))return e;const t=[];return e.toLowerCase().split(".").forEach(e=>{/^[\w-]*$/.test(e)?t.push(e):t.push("xn--"+punycode.encode(e))}),t.join(".")}const toutf16={decode(e){const t=[];let n=0;const o=e.length;let r,i;for(;n<o;){if(r=e.charCodeAt(n++),55296==(63488&r)){if(i=e.charCodeAt(n++),55296!=(64512&r)||56320!=(64512&i))throw new RangeError("utf16.decode: illegal sequence");r=((1023&r)<<10)+(1023&i)+65536}t.push(r)}return t},encode(e){const t=[];let n=0;const o=e.length;let r;for(;n<o;){if(r=e[n++],55296==(63488&r))throw new RangeError("utf16.encode: illegal value");r>65535&&(r-=65536,t.push(String.fromCharCode(r>>>10&1023|55296)),r=56320|1023&r),t.push(String.fromCharCode(r))}return t.join("")}};function tounicode(e){if(!e)return e;const t=[];return e.toLowerCase().split(".").forEach(e=>{0==e.indexOf("xn--")?t.push(punycode.decode(e.replace("xn--",""))):t.push(e)}),t.join(".")}function getLocale(){const e=chrome.i18n.getUILanguage().replace("_","-");return e.length<7?e:"en-US"}function validateDomain(e){return VALID_HOSTNAME.test(e)?e:""}function compareVersions(e,t){if(e===t)return 0;const n=e.split("."),o=t.split("."),r=Math.min(n.length,o.length);for(let e=0;e<r;e++){if(parseInt(n[e])>parseInt(o[e]))return 1;if(parseInt(n[e])<parseInt(o[e]))return-1}return n.length>o.length?1:n.length<o.length?-1:0}function getOS(){let e=null;const t=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(const n in t){const o=t[n];if(o.r.test(navigator.userAgent)){e=o.s;break}}return e}function getBrowserInfo(){const e=navigator.userAgent;let t,n=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(e)||[],{name:"IE",version:t[1]||""}):"Chrome"===n[1]&&(t=e.match(/\b(OPR|Edge|Edg|SamsungBrowser|YaBrowser)\/(\d+)/),null!=t)?{name:t[1].replace("OPR","Opera").replace("YaBrowser","Yandex").replace("SamsungBrowser","Samsung"),version:t[2]}:(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(t=e.match(/version\/(\d+)/i))&&n.splice(1,1,t[1]),{name:n[0],version:n[1]})}function generateUuidV4(){let e=Date.now();window.performance&&window.performance.now&&(e+=performance.now());return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})}function buildUrl(e,t){const n=Object.keys(t).map(e=>`${e}=${encodeURIComponent(t[e])}`).join("&");return""===e?n:-1===e.indexOf("?")?`${e}?${n}`:e+n}function getDomain(e){const t=document.createElement("a");t.href=e&&-1!==e.indexOf("://")?e:"http://"+e;const n=t.hostname.match(/([^.]+\.)?([^\.]+\..+)/);return n&&n.length>2?n[2]:t.hostname}function getRandomBool(){const e=new Uint8Array(1);return crypto.getRandomValues(e),e[0]>127}function checkLocalhost(e){return-1!==e.indexOf("//localhost/")||-1!==e.indexOf("//localhost:")}function getsharedlevel(e){return SHARED_HOSTS[e]||0}function encodehostname(e,t){try{if(!e||!t)return e;if((t=t.replace(/^\s*/g,"").replace(/\s*$/,"").replace(/[\?#].*$/,"").replace(/\/$/,"")).length<2||"/"!=t[0])return e;const n=t.split("/");if(!n||!n.length)return e;"/"!=t[t.length-1]&&/\.[^\.]{1,6}$/.test(n[n.length-1])&&n.pop();let o=0;for(let t=n.length;!o&&t>0;--t)o=this.getsharedlevel(e+n.slice(0,t).join("/"));if(!o)return e;const r=n.slice(0,o+1).join("/").replace(/^\//,"");if(!r||!r.length)return e;const i=WotCrypto.base32.encode(r);return null==i?e:`_p_${i}.${e}`}catch(e){}return e}function getCleanDomain(e){if(!e)return e;e=e.trim(),/^https?:\/\//.test(e)||(e="http://"+e);try{return new URL(e).hostname.replace(/^www\d*\./,"")}catch(t){return e}}function getEncodedDomain(e){if(!e)return e;e=(e=e&&-1!==e.indexOf("://")?e:"http://"+e).replace(/^\s*/,"").replace(/\s*$/,"").replace("://www.","://");const t=document.createElement("a");let n;if(t.href=e,n=t.hostname,SUPPORTED_PROTOCOLS.test(e)){const t=/^(\w+):\/\/(([^:@]+)(:([^@]+))?@)?([^:\/\?&=#\[\]]+|\[[^\/\?&=#\[\]]+\])\.?(:(\d+))?(.*)$/.exec(e);return t&&n?(n=toascii(n),encodehostname(n,t[9])):n}}function getDecodedDomain(e){try{const t=/^_p_([a-z2-7]+)\.(.+)$/.exec(e);if(!t||!t[1]||!t[2])return tounicode(e);const n=WotCrypto.base32.decode(t[1]);return null==n?tounicode(e):`${tounicode(t[2])}/${n}`}catch(e){}return tounicode(e)}